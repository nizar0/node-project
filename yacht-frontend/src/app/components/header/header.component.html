<div class="notification-weather-container">
  <div class="notification-icon" (click)="toggleNotifications()">
    <i class="fas fa-bell"></i>
    <span *ngIf="unreadCount > 0" class="badge">{{ unreadCount }}</span>
  </div>

  <div class="weather-icon" (click)="toggleWeather()">
    <i class="fas fa-cloud-sun"></i>
  </div>
</div>

<div *ngIf="showNotifications" class="notification-dropdown">
  <div class="notification-header">
    <h4>Notifications</h4>
    <span class="badge">{{ unreadCount }}</span>
    <button *ngIf="unreadCount > 0" class="mark-all-btn" (click)="markAllAsRead($event)">Tout marquer comme lu</button>
  </div>
  <ul class="notification-list">
    <li *ngFor="let notification of notifications" (click)="goToNotification(notification)">
      <img [src]="getUrl(notification.userCreate.image) || 'assets/default-avatar.png'" alt="Notification Icon" />
      <div class="notification-details">
        <p>
          <strong>{{ notification.senderName }}</strong> {{ notification.message }}
        </p>
        <small>{{ notification.createdAt | date: 'yyyy/MM/dd hh:mm a' }}</small>
      </div>
    </li>
  </ul>
  <p *ngIf="notifications.length === 0" class="no-notifications">Aucune notification disponible</p>
</div>

<div *ngIf="showWeather" class="weather-dropdown">
  <div class="weather-header">
    <h4>Météo</h4>
  </div>

  <!-- 🌍 Search Bar with Country List -->
  <div class="search-bar">
    <input type="text" [(ngModel)]="searchTerm" (input)="filterCountries()" placeholder="Rechercher un pays..." />
    <ul class="country-list" *ngIf="filteredCountries.length">
      <li *ngFor="let country of filteredCountries" (click)="selectCountry(country)">
        <img [src]="country.flag" class="country-flag" alt="{{ country.name }}" />
        {{ country.name }}
      </li>
    </ul>
  </div>

  <!-- 🔄 Loading Animation -->
  <div *ngIf="isLoading" class="loading">Chargement...</div>

  <!-- 🌦️ Weather Details -->
  <div *ngIf="weatherData" class="weather-details">
    <h3>
      {{ weatherData.name }}, {{ weatherData.country }}
    </h3>
    <img [src]="weatherData.icon" alt="Weather Icon" class="weather-icons" />
    <p>🌡 Température: <strong>{{ weatherData.temp }}°C</strong></p>
    <p>💧 Humidité: <strong>{{ weatherData.humidity }}%</strong></p>
    <p>🌬 Vent: <strong>{{ weatherData.windSpeed }} km/h</strong></p>
    <p>📌 Condition: <strong>{{ weatherData.description }}</strong></p>
  </div>
</div>
