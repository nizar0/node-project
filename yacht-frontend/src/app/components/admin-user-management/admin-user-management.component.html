<app-header/>
<div class="admin-container">
  <h2 class="text-center">Gestion des Utilisateurs</h2>

  <!-- Tab Buttons -->
  <div class="tab-buttons">
    <button class="tab-btn"
            [ngClass]="{ 'active': selectedTab === 'owners' }"
            (click)="selectTab('owners')">
      Owners
    </button>
    <button class="tab-btn"
            [ngClass]="{ 'active': selectedTab === 'clients' }"
            (click)="selectTab('clients')">
      Clients
    </button>
  </div>

  <div class="filter-container">
    <input type="text"
           class="filter-input"
           placeholder="Rechercher un utilisateur..."
           [(ngModel)]="searchQuery"
           (input)="filterUsers()">
  </div>

  <div class="tab-content">
    <!-- 🔹 Owners Tab -->
    <div *ngIf="selectedTab === 'owners'">
      <h3>Propriétaires</h3>

      <p *ngIf="filteredOwners.length === 0" class="no-data">Aucun propriétaire trouvé.</p>

      <div class="card-container">
        <div *ngFor="let owner of filteredOwners" class="user-card">
          <img [src]="getUrl(owner.image) || 'assets/default-avatar.png'" class="user-avatar" />
          <h5>{{ owner.name }}</h5>
          <p>Email: {{ owner.email }}</p>
          <div class="user-status">{{!owner.isValidatedByAdmin ? '⏳ En attente' :'✅ Approuvé' }}</div>
          <div class="action-buttons">
            <button class="btn btn-success" *ngIf ="!owner.isValidatedByAdmin" (click)="approveUser(owner._id)">✅ Approuver</button>
            <button class="btn btn-danger" *ngIf ="!owner.isBlockedByAdmin && owner.isValidatedByAdmin" (click)="blockUser(owner._id)">🚫 Bloquer</button>
            <button class="btn btn-success"  *ngIf ="owner.isBlockedByAdmin && owner.isValidatedByAdmin" (click)="deblockUser(owner._id)">✅ Débloquer</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 🔹 Clients Tab -->
    <div *ngIf="selectedTab === 'clients'">
      <h3>Clients</h3>

      <p *ngIf="filteredClients.length === 0" class="no-data">Aucun client trouvé.</p>

      <div class="card-container">
        <div *ngFor="let client of filteredClients" class="user-card">
          <img [src]="getUrl(client.image) || 'assets/default-avatar.png'" class="user-avatar" />
          <h5>{{ client.name }}</h5>
          <p>Email: {{ client.email }}</p>
          <div class="user-status">{{!client.isValidatedByAdmin ? '⏳ En attente' :'✅ Approuvé' }}</div>
          <div class="action-buttons">
            <button class="btn btn-success" *ngIf ="!client.isValidatedByAdmin" (click)="approveUser(client._id)">✅ Approuver</button>
            <button class="btn btn-danger" *ngIf ="!client.isBlockedByAdmin && client.isValidatedByAdmin" (click)="blockUser(client._id)">🚫 Bloquer</button>
            <button class="btn btn-success"  *ngIf ="client.isBlockedByAdmin && client.isValidatedByAdmin" (click)="deblockUser(client._id)">✅ Débloquer</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
